<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Post‑Reading Engagement Survey</title>
  <style>
    :root { --maxw: 860px; }
    html, body { height: 100%; }
    body {
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji", "Segoe UI Emoji";
      line-height: 1.5; margin: 0; color: #111; background: #fafafa;
    }
    .wrap { max-width: var(--maxw); margin: 0 auto; padding: 24px; }
    header { margin-bottom: 20px; }
    h1 { font-size: 1.4rem; margin: 0 0 8px; }
    p.meta { color: #555; margin: 0 0 16px; }
    form { background: #fff; border: 1px solid #e6e6e6; border-radius: 12px; padding: 16px; }
    fieldset { border: 1px solid #eee; border-radius: 10px; margin: 14px 0 18px; padding: 10px 12px 12px; }
    legend { font-weight: 600; padding: 0 6px; }
    .q { display: grid; grid-template-columns: 1fr auto; gap: 10px; align-items: center; padding: 6px 4px; border-bottom: 1px dashed #f0f0f0; }
    .q:last-child { border-bottom: 0; }
    .q-label { margin-right: 10px; }
    .scale { display: inline-grid; grid-template-columns: repeat(5, minmax(28px, 40px)); gap: 6px; }
    .scale label { display: grid; place-items: center; font-size: .95rem; padding: 6px; border: 1px solid #ddd; border-radius: 8px; cursor: pointer; }
    .scale input { appearance: none; width: 0; height: 0; position: absolute; }
    .scale input:focus-visible + label { outline: 2px solid #222; outline-offset: 2px; }
    .scale input:checked + label { border-color: #222; box-shadow: inset 0 0 0 2px #222; }
    .scale .hint { grid-column: 1 / -1; display: flex; justify-content: space-between; font-size: .8rem; color: #666; margin-top: 4px; }
    .controls { display: flex; gap: 10px; align-items: center; justify-content: space-between; margin-top: 12px; flex-wrap: wrap; }
    button { border: 1px solid #111; background: #111; color: #fff; padding: 10px 14px; border-radius: 10px; cursor: pointer; }
    button.secondary { background: #fff; color: #111; }
    .req { font-size: .85rem; color: #666; }
    textarea { width: 100%; min-height: 90px; resize: vertical; padding: 10px; border-radius: 10px; border: 1px solid #ddd; }
    .results { margin-top: 18px; background: #fff; border: 1px solid #e6e6e6; border-radius: 12px; padding: 16px; display: none; }
    table { border-collapse: collapse; width: 100%; }
    th, td { padding: 8px 10px; border-bottom: 1px solid #f0f0f0; text-align: left; }
    .hidden { display: none !important; }
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <h1>Post‑Reading Engagement Survey</h1>
      <p class="meta">Please rate each statement on a scale from <strong>1 (strongly disagree)</strong> to <strong>5 (strongly agree)</strong>. All items are required.</p>
    </header>

    <form id="survey" novalidate>
      <!-- Section 1: Engagement & Attention -->
      <fieldset>
        <legend>Section A — Engagement & Attention</legend>

        <div class="q">
          <div class="q-label">A1. I felt engaged while reading the data story.</div>
          <div class="scale" role="radiogroup" aria-label="A1 rating">
            <input id="a1-1" type="radio" name="A1" value="1" required><label for="a1-1">1</label>
            <input id="a1-2" type="radio" name="A1" value="2"><label for="a1-2">2</label>
            <input id="a1-3" type="radio" name="A1" value="3"><label for="a1-3">3</label>
            <input id="a1-4" type="radio" name="A1" value="4"><label for="a1-4">4</label>
            <input id="a1-5" type="radio" name="A1" value="5"><label for="a1-5">5</label>
          </div>
        </div>

        <div class="q">
          <div class="q-label">A2. The story maintained my attention from start to finish.</div>
          <div class="scale" role="radiogroup" aria-label="A2 rating">
            <input id="a2-1" type="radio" name="A2" value="1" required><label for="a2-1">1</label>
            <input id="a2-2" type="radio" name="A2" value="2"><label for="a2-2">2</label>
            <input id="a2-3" type="radio" name="A2" value="3"><label for="a2-3">3</label>
            <input id="a2-4" type="radio" name="A2" value="4"><label for="a2-4">4</label>
            <input id="a2-5" type="radio" name="A2" value="5"><label for="a2-5">5</label>
          </div>
        </div>

        <div class="q">
          <div class="q-label">A3. I was motivated to keep scrolling/reading.</div>
          <div class="scale" role="radiogroup" aria-label="A3 rating">
            <input id="a3-1" type="radio" name="A3" value="1" required><label for="a3-1">1</label>
            <input id="a3-2" type="radio" name="A3" value="2"><label for="a3-2">2</label>
            <input id="a3-3" type="radio" name="A3" value="3"><label for="a3-3">3</label>
            <input id="a3-4" type="radio" name="A3" value="4"><label for="a3-4">4</label>
            <input id="a3-5" type="radio" name="A3" value="5"><label for="a3-5">5</label>
          </div>
        </div>

        <div class="q">
          <div class="q-label">A4. The pacing felt appropriate (neither too slow nor too fast).</div>
          <div class="scale" role="radiogroup" aria-label="A4 rating">
            <input id="a4-1" type="radio" name="A4" value="1" required><label for="a4-1">1</label>
            <input id="a4-2" type="radio" name="A4" value="2"><label for="a4-2">2</label>
            <input id="a4-3" type="radio" name="A4" value="3"><label for="a4-3">3</label>
            <input id="a4-4" type="radio" name="A4" value="4"><label for="a4-4">4</label>
            <input id="a4-5" type="radio" name="A4" value="5"><label for="a4-5">5</label>
          </div>
        </div>

        <div class="q">
          <div class="q-label">A5. I would recommend this story to others.</div>
          <div class="scale" role="radiogroup" aria-label="A5 rating">
            <input id="a5-1" type="radio" name="A5" value="1" required><label for="a5-1">1</label>
            <input id="a5-2" type="radio" name="A5" value="2"><label for="a5-2">2</label>
            <input id="a5-3" type="radio" name="A5" value="3"><label for="a5-3">3</label>
            <input id="a5-4" type="radio" name="A5" value="4"><label for="a5-4">4</label>
            <input id="a5-5" type="radio" name="A5" value="5"><label for="a5-5">5</label>
          </div>
        </div>
      </fieldset>

      <!-- Section 2: Narrative & Clarity -->
      <fieldset>
        <legend>Section B — Narrative & Clarity</legend>

        <div class="q">
          <div class="q-label">B1. The main message of the story was clear.</div>
          <div class="scale" role="radiogroup" aria-label="B1 rating">
            <input id="b1-1" type="radio" name="B1" value="1" required><label for="b1-1">1</label>
            <input id="b1-2" type="radio" name="B1" value="2"><label for="b1-2">2</label>
            <input id="b1-3" type="radio" name="B1" value="3"><label for="b1-3">3</label>
            <input id="b1-4" type="radio" name="B1" value="4"><label for="b1-4">4</label>
            <input id="b1-5" type="radio" name="B1" value="5"><label for="b1-5">5</label>
          </div>
        </div>

        <div class="q">
          <div class="q-label">B2. Transitions between sections were smooth and understandable.</div>
          <div class="scale" role="radiogroup" aria-label="B2 rating">
            <input id="b2-1" type="radio" name="B2" value="1" required><label for="b2-1">1</label>
            <input id="b2-2" type="radio" name="B2" value="2"><label for="b2-2">2</label>
            <input id="b2-3" type="radio" name="B2" value="3"><label for="b2-3">3</label>
            <input id="b2-4" type="radio" name="B2" value="4"><label for="b2-4">4</label>
            <input id="b2-5" type="radio" name="B2" value="5"><label for="b2-5">5</label>
          </div>
        </div>

        <div class="q">
          <div class="q-label">B3. Explanations and captions were easy to follow.</div>
          <div class="scale" role="radiogroup" aria-label="B3 rating">
            <input id="b3-1" type="radio" name="B3" value="1" required><label for="b3-1">1</label>
            <input id="b3-2" type="radio" name="B3" value="2"><label for="b3-2">2</label>
            <input id="b3-3" type="radio" name="B3" value="3"><label for="b3-3">3</label>
            <input id="b3-4" type="radio" name="B3" value="4"><label for="b3-4">4</label>
            <input id="b3-5" type="radio" name="B3" value="5"><label for="b3-5">5</label>
          </div>
        </div>

        <div class="q">
          <div class="q-label">B4. The narrative structure supported comprehension.</div>
          <div class="scale" role="radiogroup" aria-label="B4 rating">
            <input id="b4-1" type="radio" name="B4" value="1" required><label for="b4-1">1</label>
            <input id="b4-2" type="radio" name="B4" value="2"><label for="b4-2">2</label>
            <input id="b4-3" type="radio" name="B4" value="3"><label for="b4-3">3</label>
            <input id="b4-4" type="radio" name="B4" value="4"><label for="b4-4">4</label>
            <input id="b4-5" type="radio" name="B4" value="5"><label for="b4-5">5</label>
          </div>
        </div>

        <div class="q">
          <div class="q-label">B5. I learned something new from this story.</div>
          <div class="scale" role="radiogroup" aria-label="B5 rating">
            <input id="b5-1" type="radio" name="B5" value="1" required><label for="b5-1">1</label>
            <input id="b5-2" type="radio" name="B5" value="2"><label for="b5-2">2</label>
            <input id="b5-3" type="radio" name="B5" value="3"><label for="b5-3">3</label>
            <input id="b5-4" type="radio" name="B5" value="4"><label for="b5-4">4</label>
            <input id="b5-5" type="radio" name="B5" value="5"><label for="b5-5">5</label>
          </div>
        </div>
      </fieldset>

      <!-- Section 3: Interaction & Visuals -->
      <fieldset>
        <legend>Section C — Interaction & Visuals</legend>

        <div class="q">
          <div class="q-label">C1. The visuals (charts/graphics) supported the story effectively.</div>
          <div class="scale" role="radiogroup" aria-label="C1 rating">
            <input id="c1-1" type="radio" name="C1" value="1" required><label for="c1-1">1</label>
            <input id="c1-2" type="radio" name="C1" value="2"><label for="c1-2">2</label>
            <input id="c1-3" type="radio" name="C1" value="3"><label for="c1-3">3</label>
            <input id="c1-4" type="radio" name="C1" value="4"><label for="c1-4">4</label>
            <input id="c1-5" type="radio" name="C1" value="5"><label for="c1-5">5</label>
          </div>
        </div>

        <div class="q">
          <div class="q-label">C2. Interactions (e.g., scrolling, hovering) felt meaningful rather than distracting.</div>
          <div class="scale" role="radiogroup" aria-label="C2 rating">
            <input id="c2-1" type="radio" name="C2" value="1" required><label for="c2-1">1</label>
            <input id="c2-2" type="radio" name="C2" value="2"><label for="c2-2">2</label>
            <input id="c2-3" type="radio" name="C2" value="3"><label for="c2-3">3</label>
            <input id="c2-4" type="radio" name="C2" value="4"><label for="c2-4">4</label>
            <input id="c2-5" type="radio" name="C2" value="5"><label for="c2-5">5</label>
          </div>
        </div>

        <div class="q">
          <div class="q-label">C3. The visual design was aesthetically pleasing.</div>
          <div class="scale" role="radiogroup" aria-label="C3 rating">
            <input id="c3-1" type="radio" name="C3" value="1" required><label for="c3-1">1</label>
            <input id="c3-2" type="radio" name="C3" value="2"><label for="c3-2">2</label>
            <input id="c3-3" type="radio" name="C3" value="3"><label for="c3-3">3</label>
            <input id="c3-4" type="radio" name="C3" value="4"><label for="c3-4">4</label>
            <input id="c3-5" type="radio" name="C3" value="5"><label for="c3-5">5</label>
          </div>
        </div>

        <div class="q">
          <div class="q-label">C4. It was easy to understand the data presented in the visuals.</div>
          <div class="scale" role="radiogroup" aria-label="C4 rating">
            <input id="c4-1" type="radio" name="C4" value="1" required><label for="c4-1">1</label>
            <input id="c4-2" type="radio" name="C4" value="2"><label for="c4-2">2</label>
            <input id="c4-3" type="radio" name="C4" value="3"><label for="c4-3">3</label>
            <input id="c4-4" type="radio" name="C4" value="4"><label for="c4-4">4</label>
            <input id="c4-5" type="radio" name="C4" value="5"><label for="c4-5">5</label>
          </div>
        </div>

        <div class="q">
          <div class="q-label">C5. The story encouraged me to explore the data further.</div>
          <div class="scale" role="radiogroup" aria-label="C5 rating">
            <input id="c5-1" type="radio" name="C5" value="1" required><label for="c5-1">1</label>
            <input id="c5-2" type="radio" name="C5" value="2"><label for="c5-2">2</label>
            <input id="c5-3" type="radio" name="C5" value="3"><label for="c5-3">3</label>
            <input id="c5-4" type="radio" name="C5" value="4"><label for="c5-4">4</label>
            <input id="c5-5" type="radio" name="C5" value="5"><label for="c5-5">5</label>
          </div>
        </div>
      </fieldset>

      <label for="comments" class="req">Optional comments</label>
      <textarea id="comments" name="comments" placeholder="Anything we should improve?"></textarea>

      <div class="controls">
        <span class="req">All questions are required. Scale: 1 = strongly disagree, 5 = strongly agree.</span>
        <div>
          <button type="button" class="secondary" id="resetBtn" aria-label="Reset form">Reset</button>
          <button type="submit" id="submitBtn" aria-label="Submit survey">Submit</button>
        </div>
      </div>
    </form>

    <section id="results" class="results" aria-live="polite" aria-atomic="true">
      <h2>Thanks! Here are your scores</h2>
      <table>
        <thead>
          <tr><th>Section</th><th>Average (1‑5)</th></tr>
        </thead>
        <tbody id="scoreRows"></tbody>
        <tfoot>
          <tr><th>Overall</th><th id="overallAvg">—</th></tr>
        </tfoot>
      </table>
      <pre id="jsonOut" class="hidden"></pre>
    </section>
  </div>

  <script>
    const form = document.getElementById('survey');
    const results = document.getElementById('results');
    const scoreRows = document.getElementById('scoreRows');
    const overallAvg = document.getElementById('overallAvg');
    const resetBtn = document.getElementById('resetBtn');

    const sections = {
      A: ['A1','A2','A3','A4','A5'],
      B: ['B1','B2','B3','B4','B5'],
      C: ['C1','C2','C3','C4','C5'],
    };

    function getVal(name) {
      const el = form.querySelector(`[name="${name}"]:checked`);
      return el ? Number(el.value) : null;
    }

    function validateAll() {
      const missing = [];
      [...form.querySelectorAll('input[type=radio][required]')].forEach(r => {
        // only mark one per group
        const groupChecked = form.querySelector(`input[name="${r.name}"]:checked`);
        if (!groupChecked && !missing.includes(r.name)) missing.push(r.name);
      });
      return missing;
    }

    form.addEventListener('submit', (e) => {
      e.preventDefault();
      const missing = validateAll();
      if (missing.length) {
        const first = form.querySelector(`[name="${missing[0]}"]`);
        if (first) first.scrollIntoView({ behavior: 'smooth', block: 'center' });
        alert('Please answer all required questions (unanswered: ' + missing.join(', ') + ').');
        return;
      }

      const payload = { sections: {}, comments: form.comments.value.trim() };
      let allValues = [];

      for (const [sec, qs] of Object.entries(sections)) {
        const vals = qs.map(getVal);
        payload.sections[sec] = Object.fromEntries(qs.map((q, i) => [q, vals[i]]));
        allValues = allValues.concat(vals);
      }

      // compute section averages
      scoreRows.innerHTML = '';
      const labels = { A: 'Engagement & Attention', B: 'Narrative & Clarity', C: 'Interaction & Visuals' };
      const avgs = [];
      for (const [sec, qs] of Object.entries(sections)) {
        const vals = qs.map(getVal);
        const avg = (vals.reduce((a, b) => a + b, 0) / vals.length).toFixed(2);
        avgs.push(Number(avg));
        const tr = document.createElement('tr');
        tr.innerHTML = `<td>${labels[sec]}</td><td>${avg}</td>`;
        scoreRows.appendChild(tr);
      }
      const overall = (allValues.reduce((a, b) => a + b, 0) / allValues.length).toFixed(2);
      overallAvg.textContent = overall;

      // Show results
      results.style.display = 'block';

      // If you want to POST the payload, replace the block below with fetch(...)
      const out = { ...payload, averages: { A: avgs[0], B: avgs[1], C: avgs[2], overall: Number(overall) } };
      const pre = document.getElementById('jsonOut');
      pre.textContent = JSON.stringify(out, null, 2);
      // pre.classList.remove('hidden'); // Uncomment to show JSON
    });

    resetBtn.addEventListener('click', () => {
      form.reset();
      results.style.display = 'none';
    });
  </script>
</body>
</html>